# ðŸš€ Deploy Your BookMySeat App to Render - EASIEST METHOD

## Why This Is The Best Choice

âœ… **Built-in PostgreSQL database** - No Neon setup needed
âœ… **Persistent storage** - Movie posters persist
âœ… **Native cron jobs** - Seat cleanup works automatically
âœ… **Free tier** - $0/month
âœ… **Setup time** - 10 minutes total
âœ… **Auto-deploy** - Push to GitHub = auto-deploy

---

## ðŸ“‹ What You'll Get

After deployment:
- ðŸŒ Live URL: `https://bookmyseat.onrender.com`
- ðŸ—„ï¸ PostgreSQL database (automatic)
- ðŸ“ File storage for movie posters
- â° Cron job for seat cleanup
- ðŸ” HTTPS (automatic)
- ðŸš€ Auto-deploy on git push

---

## ðŸŽ¯ Step-by-Step Deployment (10 Minutes)

### Step 1: Create Render Account (1 minute)

1. Go to: **https://render.com**
2. Click **"Get Started"** or **"Sign Up"**
3. **Sign in with GitHub** (recommended - easiest)
4. Authorize Render to access your repositories
5. You'll be redirected to Render dashboard

---

### Step 2: Create PostgreSQL Database (2 minutes)

**Important:** Create database FIRST, then web service!

1. In Render dashboard, click **"New +"** button (top right)
2. Select **"PostgreSQL"**
3. Configure database:
   - **Name**: `bookmyseat-db`
   - **Database**: `bookmyseat` (or leave default)
   - **User**: Leave default
   - **Region**: Choose closest to you:
     - ðŸ‡ºðŸ‡¸ Oregon (US West)
     - ðŸ‡ºðŸ‡¸ Ohio (US East)
     - ðŸ‡ªðŸ‡º Frankfurt (Europe)
     - ðŸ‡¸ðŸ‡¬ Singapore (Asia)
   - **PostgreSQL Version**: 16 (latest)
   - **Plan**: **Free** (select this!)
4. Click **"Create Database"**
5. Wait 1-2 minutes for database to be created
6. **IMPORTANT:** Keep this tab open - you'll need the **Internal Database URL**

---

### Step 3: Create Web Service (3 minutes)

1. Click **"New +"** button again
2. Select **"Web Service"**
3. Connect your repository:
   - If not connected: Click **"Connect GitHub"**
   - Find and select: **`venkyok/book-my-seat`**
   - Click **"Connect"**
4. Configure web service:

**Basic Settings:**
- **Name**: `bookmyseat` (or your preferred name)
- **Region**: **Same as your database!** (important)
- **Branch**: `main`
- **Root Directory**: Leave empty (or `./`)
- **Runtime**: Python 3
- **Plan**: **Free**

**Build & Deploy:**
- **Build Command**: 
  ```
  pip install --upgrade pip && pip install -r requirements.txt && python manage.py collectstatic --no-input && python manage.py migrate
  ```

- **Start Command**:
  ```
  gunicorn bookmyseat.wsgi:application
  ```

5. **DON'T CLICK "Create Web Service" YET!**
   Scroll down to environment variables first â¬‡ï¸

---

### Step 4: Add Environment Variables (3 minutes)

Still on the "Create Web Service" page, scroll to **"Environment Variables"** section.

Click **"Add Environment Variable"** for each:

#### Required Variables:

| Key | Value | How to Get |
|-----|-------|------------|
| `SECRET_KEY` | Click **"Generate"** button | Auto-generated by Render |
| `DEBUG` | `False` | Type manually |
| `ALLOWED_HOSTS` | `.onrender.com` | Type manually |
| `DATABASE_URL` | (see below) | Copy from database |

#### Get DATABASE_URL:

1. Open your database tab (from Step 2)
2. Scroll to **"Connections"** section
3. **Copy the "Internal Database URL"** (looks like):
   ```
   postgresql://user:pass@dpg-xxx-a.oregon-postgres.render.com/bookmyseat_xxx
   ```
4. **IMPORTANT:** Use **Internal** not External!
5. Paste this as the value for `DATABASE_URL`

#### Optional (Payment Gateway):

| Key | Value |
|-----|-------|
| `RAZORPAY_KEY_ID` | Your Razorpay test key |
| `RAZORPAY_KEY_SECRET` | Your Razorpay test secret |
| `STRIPE_PUBLIC_KEY` | Your Stripe public key (optional) |
| `STRIPE_SECRET_KEY` | Your Stripe secret key (optional) |

#### Summary - Your Environment Variables:

```
SECRET_KEY = (click Generate)
DEBUG = False
DATABASE_URL = postgresql://user:pass@dpg-xxx.render.com/bookmyseat
ALLOWED_HOSTS = .onrender.com
RAZORPAY_KEY_ID = rzp_test_xxxxx (optional)
RAZORPAY_KEY_SECRET = your_secret (optional)
```

---

### Step 5: Deploy! (1 minute)

1. After adding all environment variables
2. Click **"Create Web Service"** button at bottom
3. Render will start building your app
4. Watch the build logs (automatically shown)

**Expected build time:** 5-10 minutes

**You'll see:**
```
==> Downloading code
==> Installing Python dependencies
==> Collecting static files
==> Running migrations
==> Build succeeded!
==> Starting service
==> Your service is live at: https://bookmyseat.onrender.com
```

---

### Step 6: Create Superuser (2 minutes)

After deployment succeeds, create an admin user:

1. In your web service dashboard, click **"Shell"** in left menu
2. A terminal will open
3. Run:
   ```bash
   python manage.py createsuperuser
   ```
4. Enter:
   - Username: `admin` (or your choice)
   - Email: your email
   - Password: choose strong password
   - Confirm password
5. Type `exit` to close shell

---

### Step 7: Add Sample Data (3 minutes)

1. Visit: `https://bookmyseat.onrender.com/admin/`
2. Login with superuser credentials
3. Add some data:
   - **Movies** (add 2-3 movies with details)
   - **Theaters** (add 1-2 theaters)
   - **Seats** (add 20-30 seats per theater)

**For movie posters:**
- Upload images OR use external URLs
- External URL example: `https://image.tmdb.org/t/p/w500/poster.jpg`

---

### Step 8: Setup Seat Cleanup Cron Job (2 minutes)

To automatically clean expired seat reservations:

1. In Render dashboard, click **"New +"**
2. Select **"Cron Job"**
3. Configure:
   - **Name**: `cleanup-expired-seats`
   - **Command**: `python manage.py cleanup_reservations`
   - **Schedule**: `*/5 * * * *` (every 5 minutes)
   - **Region**: Same as your web service
4. **Environment Variables**: Click "Add from Web Service"
   - Select your `bookmyseat` web service
   - All variables will be copied
5. Click **"Create Cron Job"**

---

## âœ… Deployment Complete!

Your app is now live! ðŸŽ‰

**Your URLs:**
- **Homepage**: `https://bookmyseat.onrender.com`
- **Admin Panel**: `https://bookmyseat.onrender.com/admin/`

---

## ðŸ§ª Test Your Deployment

### 1. Homepage Test
Visit: `https://bookmyseat.onrender.com`
- Should show movie list
- Filter by genre/language should work

### 2. Admin Panel Test
Visit: `https://bookmyseat.onrender.com/admin/`
- Login with superuser
- Should see dashboard with analytics

### 3. Booking Flow Test
1. Select a movie
2. Choose theater and show time
3. Select seats
4. See payment page
5. Timer counts down
6. Test payment (use test card)

### 4. Email Test
Check console logs for booking confirmation emails

---

## ðŸŽ¯ Post-Deployment Checklist

- [ ] App loads without errors
- [ ] Admin panel accessible
- [ ] Movies display correctly
- [ ] Seat selection works
- [ ] Payment page loads
- [ ] Timer works (5-minute countdown)
- [ ] Cron job created for seat cleanup
- [ ] Sample data added

---

## ðŸ”§ Manage Your App

### View Logs
1. Go to your web service dashboard
2. Click **"Logs"** tab
3. See real-time application logs

### Redeploy
1. Go to **"Manual Deploy"** dropdown
2. Click **"Deploy latest commit"**
3. Or click **"Clear build cache & deploy"** if needed

### Update Code
```powershell
# Make changes locally
git add .
git commit -m "Update feature"
git push origin main
# Render auto-deploys! âœ…
```

### Environment Variables
1. Go to **"Environment"** tab
2. Add/edit/delete variables
3. Service auto-restarts

### Database Management
1. Click your database service
2. View connection details
3. Connect with pgAdmin or DBeaver

---

## ðŸ†˜ Troubleshooting

### Build Failed

**Check build logs for specific error:**

1. **"No module named 'xxx'"**
   - Add missing package to requirements.txt
   - Push to GitHub

2. **"collectstatic failed"**
   - Check STATIC_ROOT in settings.py
   - Should be: `STATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')`

3. **"Migration failed"**
   - Database connection issue
   - Check DATABASE_URL is correct (Internal URL)

### Service Won't Start

1. **Check Start Command**
   - Should be: `gunicorn bookmyseat.wsgi:application`

2. **Check Environment Variables**
   - SECRET_KEY must be set
   - DATABASE_URL must be Internal URL
   - ALLOWED_HOSTS must include `.onrender.com`

### Database Connection Error

1. **Use Internal Database URL**, not External
2. Database and web service in **same region**
3. DATABASE_URL copied correctly (no extra spaces)

### Static Files Not Loading

1. Check build logs show "Collecting static files"
2. Verify WhiteNoise in requirements.txt
3. STATIC_ROOT configured in settings.py

### App Sleeps After 15 Minutes

**Free tier limitation:**
- Service spins down after 15 min inactivity
- Wakes up on first request (~30 seconds)
- **Solution:** Upgrade to paid plan ($7/month) for always-on

---

## ðŸ’° Costs

### Free Tier:
- Web Service: Free (spins down after 15 min)
- PostgreSQL: Free (256MB, 90 days)
- Cron Job: Free
- Total: **$0/month**

### Paid Tier (Optional):
- Web Service: $7/month (always on, 512MB RAM)
- PostgreSQL: $7/month (1GB, persistent)
- Total: **$14/month**

**Free tier is perfect for testing and small projects!**

---

## ðŸŽ‰ What You Just Accomplished

âœ… Deployed Django app to production
âœ… PostgreSQL database configured
âœ… Static files serving with WhiteNoise
âœ… Automatic HTTPS enabled
âœ… Cron job for background tasks
âœ… Admin panel accessible
âœ… Auto-deploy on git push
âœ… Live at: `https://bookmyseat.onrender.com`

---

## ðŸ“š Next Steps

### 1. Configure Email Service (Production)

For real email notifications:

**Option A: SendGrid (100 emails/day free)**
1. Sign up at sendgrid.com
2. Get API key
3. Add to Render environment variables:
   ```
   EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
   EMAIL_HOST=smtp.sendgrid.net
   EMAIL_PORT=587
   EMAIL_USE_TLS=True
   EMAIL_HOST_USER=apikey
   EMAIL_HOST_PASSWORD=your_sendgrid_api_key
   ```

**Option B: Gmail (Less secure, not recommended for production)**

### 2. Setup Custom Domain (Optional)

1. Buy domain (Namecheap, GoDaddy, etc.)
2. In Render dashboard â†’ Settings â†’ Custom Domains
3. Add your domain
4. Update DNS records
5. Update ALLOWED_HOSTS:
   ```
   ALLOWED_HOSTS=.onrender.com,yourdomain.com,www.yourdomain.com
   ```

### 3. Enable Payment Gateway Live Mode

When ready for real payments:
1. Get live keys from Razorpay/Stripe
2. Update environment variables with live keys
3. Test with small transaction

### 4. Add Monitoring

Consider adding:
- **Sentry** - Error tracking
- **Google Analytics** - User tracking
- **UptimeRobot** - Keep service awake (free tier)

---

## ðŸ”— Useful Links

- **Render Dashboard**: https://dashboard.render.com
- **Render Docs**: https://render.com/docs
- **Your App**: https://bookmyseat.onrender.com
- **GitHub Repo**: https://github.com/venkyok/book-my-seat

---

## âœ… Success Criteria

You'll know deployment is successful when:

1. âœ… Homepage loads: `https://bookmyseat.onrender.com`
2. âœ… Admin accessible: `https://bookmyseat.onrender.com/admin/`
3. âœ… Can add movies, theaters, seats
4. âœ… Booking flow works end-to-end
5. âœ… Payment page loads
6. âœ… No errors in logs

---

**Ready to deploy? Let's do it!** ðŸš€

Follow the steps above, and let me know if you hit any issues. I'm here to help!
